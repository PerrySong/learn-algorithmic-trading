# OBV (On Balance Volume )# * OBV is a momentum indicator which uses changes in trading volume as an indicator of future asset price moves.import pandas_datareader.data as pdrimport numpy as npimport datetime# Download historical data for reuired stocksticker = 'NIO'ohlcv = pdr.get_data_yahoo(ticker, datetime.date.today() - datetime.timedelta(1025), datetime.date.today())def OBV(DF):    '''    Function to calculate On Balance Volume    Parameters    ----------    DF : DataFrame        input DF.    Returns    -------    DataFrame.    '''    df = DF.copy()    df['daily_ret'] = df['Adj Close'].pct_change() # ret: return; pct: percentage change    df['direction'] = np.where(df['daily_ret'] >= 0, 1, -1)    df['direction'][0] = 0    df['vol_adj'] = df['Volume'] * df['direction']    df['obv'] = df['vol_adj'].cumsum()    return df['obv']obv = OBV(ohlcv)    